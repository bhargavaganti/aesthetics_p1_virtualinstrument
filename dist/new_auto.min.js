"use strict";function cell(i,e,s,t,r,a){this.x=i,this.y=e,this.curr_value=s,this.future_value=t,this.colour=a,this.scene_mesh=null}function automaton(i,e,s,t,r,a,o){var _=arguments.length<=7||void 0===arguments[7]?!1:arguments[7];this.array_size=i,this.cell_size=e;(new THREE.TextureLoader).load("textures/white.jpg");this.dead_material=new THREE.MeshBasicMaterial({color:s,wireframe:!0,visible:_}),this.live_material=new THREE.MeshBasicMaterial({color:t,wireframe:!0}),this.x_offset=r,this.y_offset=a,this.z_offset=o,this.body=[],this.initialize_body=a_initialize_body,this.calc_live_neighbours=a_calc_live_neighbours,this.rotate_cells=a_rotate_cells,this.calc_future_values=a_calc_future_values,this.update_curr_values=a_update_curr_values,this.update_colours=a_update_colours,this.update_empty_colours=a_update_empty_colours,this.draw=a_draw,this.exec_cb_on_cell_state=a_exec_cb_on_cell_state,this.detect_clicks=a_detect_clicks}var ionian=[0,2,4,5,7,9,11],i=void 0,j=void 0,x=void 0,y=void 0,a_initialize_body=function(){for(i=0;i<this.array_size;i++)for(this.body[i]=[],j=0;j<this.array_size;j++)this.body[i][j]=new cell(i,j,0,0,"white"),this.body[i][j].curr_value=Math.floor(2*Math.random()),this.body[i][j].scene_mesh=new THREE.Mesh(geometry,this.dead_material),scene.add(this.body[i][j].scene_mesh),this.body[i][j].scene_mesh.position.x=this.x_offset+100*i,this.body[i][j].scene_mesh.position.z=-1*(this.y_offset+100*j),this.body[i][j].scene_mesh.position.y=this.z_offset;return this},a_calc_live_neighbours=function(){for(i=0;i<this.array_size;i++)for(j=0;j<this.array_size;j++)for(this.body[i][j].live_neighbours=0,x=-1;1>=x;x++)for(y=-1;1>=y;y++)(0!=x||0!=y)&&i+x<this.array_size&&j+y<this.array_size&&i+x>0&&j+y>0&&1==this.body[i+x][j+y].curr_value&&this.body[i][j].live_neighbours++},a_rotate_cells=function(){for(i=0;i<this.array_size;i++)for(j=0;j<this.array_size;j++)this.body[i][j].scene_mesh.rotation.y+=.5},a_calc_future_values=function(){for(i=0;i<this.array_size;i++)for(j=0;j<this.array_size;j++)this.body[i][j].live_neighbours<2&&1==this.body[i][j].curr_value?this.body[i][j].future_value=0:3!=this.body[i][j].live_neighbours&&2!=this.body[i][j].live_neighbours||1!=this.body[i][j].curr_value?this.body[i][j].live_neighbours>3&&1==this.body[i][j].curr_value?this.body[i][j].future_value=0:3==this.body[i][j].live_neighbours&&0==this.body[i][j].curr_value?this.body[i][j].future_value=1:this.body[i][j].future_value=0:this.body[i][j].future_value=1},a_update_curr_values=function(){for(i=0;i<this.array_size;i++)for(j=0;j<this.array_size;j++)this.body[i][j].curr_value=this.body[i][j].future_value},a_update_colours=function(){for(i=0;i<this.array_size;i++)for(j=0;j<this.array_size;j++)1==this.body[i][j].curr_value?this.body[i][j].scene_mesh.material=this.live_material:this.body[i][j].scene_mesh.material=this.dead_material},a_update_empty_colours=function(){for(i=0;i<this.array_size;i++)for(j=0;j<this.array_size;j++);},a_draw=function(e){for(i=0;i<this.array_size;i++)for(j=0;j<this.array_size;j++);},a_exec_cb_on_cell_state=function(e,s){for(i=0;i<this.array_size;i++)for(j=0;j<this.array_size;j++)1==this.body[i][j].curr_value&&Math.random()>.9&&play_randnote(e,0,s+ionian[(i*this.array_size+j)%7],30,0)},a_detect_clicks=function(e){if(null!=e[0]&&null!=e[1])for(console.log("detecting clicks"),i=0;i<this.array_size;i++)for(j=0;j<this.array_size;j++)x_coord=e[0],y_coord=e[1],x_coord>this.x_offset+i*this.cell_size&&x_coord<this.x_offset+(i+1)*this.cell_size&&y_coord>this.y_offset+j*this.cell_size&&y_coord<this.y_offset+(j+1)*this.cell_size&&(console.log("click detected!"),this.body[i][j].curr_value=1)};